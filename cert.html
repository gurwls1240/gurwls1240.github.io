
<!DOCTYPE html>
<html>
<head>
<title>EDU Block Certification</title>
</head>
<meta charset="utf-8">
<link href="plugins/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="styles/course.css">
<body>
<div style="border: 10px double #14bdee; padding: 50px 30px 40px 30px; margin: 0px auto 10px auto; text-align: center; font-family: Helvetica, Arial, sans-serif; width: 800px;">
		<div class="logo"><img src="images/eduBlock.png"></div>
		<p style="font-family: 'Times New Roman', serif; font-size: 33px; font-weight: bold; color: #14bdee !important; margin: 35px;">EDU Block Certificate</p>
		<p style="font-size: 16px;" >To : <strong id="to"></strong></p>
		<p style="font-size: 16px;" font-style:italic; id="describe"></p>
		
 
		<hr style="margin: 20px 20px 20px 20px; border: double; color: #14bdee; height: 4px;">
 
		<h3>Thank you for using Edu block to learn and teach      
			<br><br>- 내가 강의한 목록 - <br>
			<ul id="showCourses"></ul>   
			<br><br>- 내가 학업한 목록 - <br>
			<ul id="showLectures"></ul>
		
	        </h3>
	
		<h2>위의 사실을 증명합니다.</h2>
		<p>This certificate is proved by EduBlock. All Rights Reserved. Copyright by Edublock.</p>		
	</div>
  
  
  </body>
	
<script src="https://cdn.rawgit.com/ethereum/web3.js/develop/dist/web3.js"></script>
<!-- script src="https://code.jquery.com/jquery-3.1.1.slim.min.js"></script -->
	<script src="js/jquery-3.2.1.min.js"></script>
<script src="styles/bootstrap4/popper.js"></script>
<script src="styles/bootstrap4/bootstrap.min.js"></script>
<script src="plugins/greensock/TweenMax.min.js"></script>
<script src="plugins/greensock/TimelineMax.min.js"></script>
<script src="plugins/scrollmagic/ScrollMagic.min.js"></script>
<script src="plugins/greensock/animation.gsap.min.js"></script>
<script src="plugins/greensock/ScrollToPlugin.min.js"></script>
<script src="plugins/OwlCarousel2-2.2.1/owl.carousel.js"></script>
<script src="plugins/easing/easing.js"></script>
<script src="plugins/parallax-js-master/parallax.min.js"></script>
<script src="js/custom.js"></script>		
<script>
    var contractAddress = '0x40f5389fc678f89694efb00cf534d3358c6b4ba2';
	var abi = [ { "constant": true, "inputs": [], "name": "name", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "_spender", "type": "address" }, { "name": "_value", "type": "uint256" } ], "name": "approve", "outputs": [ { "name": "success", "type": "bool" } ], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [ { "name": "_address", "type": "address" } ], "name": "getMyLectureNum", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "totalSupply", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "_from", "type": "address" }, { "name": "_to", "type": "address" }, { "name": "_value", "type": "uint256" } ], "name": "transferFrom", "outputs": [ { "name": "success", "type": "bool" } ], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [ { "name": "_index", "type": "uint256" } ], "name": "getStudyList2", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "", "type": "address" } ], "name": "balances", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "_day", "type": "uint256" }, { "name": "_month", "type": "string" }, { "name": "_studytitle", "type": "string" }, { "name": "_sodyd", "type": "string" }, { "name": "_studyclocka", "type": "string" }, { "name": "_map", "type": "string" } ], "name": "uploadStudy", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "decimals", "outputs": [ { "name": "", "type": "uint8" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "_name", "type": "string" } ], "name": "createPerson", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [ { "name": "_key", "type": "bytes32" } ], "name": "checkMyCourse", "outputs": [ { "name": "", "type": "bool" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_address", "type": "address" }, { "name": "_index", "type": "uint256" } ], "name": "getMyClass", "outputs": [ { "name": "", "type": "bytes32" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "", "type": "address" }, { "name": "", "type": "address" } ], "name": "allowed", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_key", "type": "bytes32" } ], "name": "getReviewStar", "outputs": [ { "name": "", "type": "uint256" }, { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_key", "type": "bytes32" } ], "name": "getVideo", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_owner", "type": "address" } ], "name": "balanceOf", "outputs": [ { "name": "balance", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_key", "type": "bytes32" } ], "name": "getReviewNum", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "symbol", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "_to", "type": "address" }, { "name": "_value", "type": "uint256" } ], "name": "transfer", "outputs": [ { "name": "success", "type": "bool" } ], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "getVideoNum", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_address", "type": "address" } ], "name": "getMyClassNum", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_address", "type": "address" }, { "name": "_index", "type": "uint256" } ], "name": "getMyLecture", "outputs": [ { "name": "", "type": "bytes32" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "_video", "type": "string" }, { "name": "_category", "type": "string" }, { "name": "_title", "type": "string" }, { "name": "_summary", "type": "string" }, { "name": "_price", "type": "uint16" } ], "name": "uploadVideo", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "getPersonNum", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "_key", "type": "bytes32" }, { "name": "_star", "type": "uint8" }, { "name": "_content", "type": "string" } ], "name": "setReview", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [ { "name": "_key", "type": "bytes32" }, { "name": "_index", "type": "uint256" } ], "name": "getReview", "outputs": [ { "name": "", "type": "uint256" }, { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_key", "type": "bytes32" } ], "name": "getVideoDetail", "outputs": [ { "name": "", "type": "string" }, { "name": "", "type": "string" }, { "name": "", "type": "string" }, { "name": "", "type": "string" }, { "name": "", "type": "uint256" }, { "name": "", "type": "uint256" }, { "name": "", "type": "address" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_owner", "type": "address" }, { "name": "_spender", "type": "address" } ], "name": "allowance", "outputs": [ { "name": "remaining", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_index", "type": "uint256" } ], "name": "getVideoList", "outputs": [ { "name": "", "type": "bytes32" }, { "name": "", "type": "string" }, { "name": "", "type": "string" }, { "name": "", "type": "string" }, { "name": "", "type": "uint256" }, { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_add", "type": "address" } ], "name": "getTeacherTotal", "outputs": [ { "name": "", "type": "uint256" }, { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_index", "type": "uint256" } ], "name": "getStudyList", "outputs": [ { "name": "", "type": "string" }, { "name": "", "type": "uint256" }, { "name": "", "type": "string" }, { "name": "", "type": "string" }, { "name": "", "type": "string" }, { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "_key", "type": "bytes32" } ], "name": "payForCourse", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "getStudyNum", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "inputs": [ { "name": "_CEOaddress", "type": "address" } ], "payable": false, "stateMutability": "nonpayable", "type": "constructor" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "_from", "type": "address" }, { "indexed": true, "name": "_to", "type": "address" }, { "indexed": false, "name": "_value", "type": "uint256" } ], "name": "Transfer", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "_owner", "type": "address" }, { "indexed": true, "name": "_spender", "type": "address" }, { "indexed": false, "name": "_value", "type": "uint256" } ], "name": "Approval", "type": "event" } ];
	var EDBContract;
	var EDB;
	
	window.addEventListener('load', function() {
	// Checking if Web3 has been injected by the browser (Mist/MetaMask)
		if (typeof web3 !== 'undefined') {
			// Use Mist/MetaMask's provider
			window.web3 = new Web3(web3.currentProvider);
		} else {
			console.log('No web3? You should consider trying MetaMask!')
			// fallback - use your fallback strategy (local node / hosted node + in-dapp id mgmt / fail)
			window.web3 = new Web3(new Web3.providers.HttpProvider("https://ropsten.infura.io/v3/ae6f0ffba6464191af24a26af5d50df1"));
		}
	// Now you can start your app & access web3 freely:
	startApp();
	});
	
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	function startApp() {
		EDBContract = web3.eth.contract(abi);
		EDB = EDBContract.at(contractAddress);
		
		web3.eth.getAccounts(function(e,r){
			$("#to").append(r[0]);
			$("#describe").append("Specifies the certificate is issued to [" + r[0] + "] for EDU BLOCK.");
		});

		getClass();
        getLecture();
	}

  	function getClass() {
		$("#showCourses").empty();

		web3.eth.getAccounts(function(e,r){
			EDB.getMyClassNum(r[0], function(e,r){
				for(i = r-1; i>-1; i--){
					getClassDetail(i);
				}
			});
  		});
	}

	function getClassDetail(a){
		web3.eth.getAccounts(function(e,r){
			EDB.getMyClass(r[0], a,function(e,r){
				var key = r;
				EDB.getVideoDetail(r,function(e,r){
					var r = r;
					EDB.getReviewStar(key, function(e,r2){
						var star;
						if(r2[1] != 0) star = r2[0]/r2[1];
						else star = 0;
						$("#showCourses").append($('<br><li>강의 : <a style="text-decoration:none; color:#14bdee;" href="javascript:viewDetail(\'' + key +'\')" ><span>'+ r[2]+'</span></a><br>선생님 : ' + r[0] + '<br>카테고리 : ' + r[1] + ' / 학생수 : ' + r[5] + '명 / 강의평점 : <div class="rating_r rating_r_' + star + '"><i></i><i></i><i></i><i></i><i></i></div><br>강의내용 : ' + r[3] + '</li>'));
					});
				});
			});
  		});
	}
	
  	function getLecture() {
		$("#showLectures").empty();
	  
		web3.eth.getAccounts(function(e,r){
			EDB.getMyLectureNum(r[0], function(e,r){
				for(i = r-1; i>-1; i--){
					getLectureDetail(i);
				}
			});
		});
  	}

	function getLectureDetail(a){
		web3.eth.getAccounts(function(e,r){
			EDB.getMyLecture(r[0], a,function(e,r){
				var key = r;
				EDB.getVideoDetail(r,function(e,r){
					var r = r;
					EDB.getReviewStar(key, function(e,r2){
						var star;
						if(r2[1] != 0) star = parsInt(r2[0]/r2[1]);
						else star = 0;
						$("#showLectures").append($('<br><li>강의 : <a style="text-decoration:none; color:#14bdee;" href="javascript:viewDetail(\'' + key +'\')" ><span>'+ r[2]+'</span></a><br>선생님 : ' + r[0] + '<br>카테고리 : ' + r[1] + ' / 학생수 : ' + r[5] + '명 / 강의평점 : <div class="rating_r rating_r_' + star + '"><i></i><i></i><i></i><i></i><i></i></div><br>강의내용 : ' + r[3] + '</li>'));
					});
				});
			});
		});
	}
	
	function viewDetail(obj){
		window.location = "course.html?" + obj;
	}
	
</script>	
	
  </html>
